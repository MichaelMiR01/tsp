Introduction

  - Brief description and example code
  - Fallback to Tcl proc if compilation fails

Tcl Static Prime (tsp) is a compiler for the Tcl langauge that produces C or Java code, which 
is then compiled on-the-fly during execution of a Tcl program.  TSP compiles select 
Tcl *procs*, not an entire program.   TSP can speed up procs by several orders of magnitude,
at a slight cost in Tcl language features.  Procs that are not able to be compiled due to
unsupported features are instead defined as normal Tcl procedures and executed by the Tcl
interpreter.  TSP is written entirely in Tcl, and uses the Tcl extension *tclparser* for
low level command and expression parsing.  


  - Use of native types

TSP achieves much of its performance increases due to use of natives types. Integers are defined
as native 64-bit integer types, doubles as 64 bit double types, booleans as target language 
appropriate types (int or boolean).  Strings are stored as dynamically sizeable types or 
structures (with library support).  Tcl objects are also used for non-native types, such as
lists and dicts.  The only variables that are explicitly given to the Tcl interpreter for
storage and management are arrays, whose elements are already Tcl Objects.  


  - TSP pragmas (annotations) for proc and variable definitions

The use of native types requires that the programmer define variable usage through use of
compile time pragmas, that is, annotations in the form of Tcl comments.  Besides defining
variable types, Tcl procs are also annotated to define the return type of the proc.

  - Subset of Tcl language

TSP also requires that a subset of the Tcl language be used to compile procs.  This is required
to that the TSP compiler can easily track type information of variables and proc.  

  - Trends of other systems: asm.js, typescript.js, python type annotations proposal, mira (ruby)

TSP follows a trend of compiling other dynamic languages.  Notably the languages subset asm.js and
typescript.js are subsets of Javascript/Emcascript to support producing efficient and type safe code.
asm.js allows runtime Javascript interpreters to JIT compile Javascript to machine code.  Python 
is now exploring type annotations as well.  Another example is the Mira language, that uses type
annotations to efficiently compile Ruby to Java classes.

  - Use of profiler to target procs

TSP is best used selectively.  In a typical "80% / 20%" scenario,  the bulk of program execution
time is confined to approximately 20% of the actual code.  Likely candidate procs are those that
perform math operations or loop over one or more lists tsp of items.  Profiling Tcl programs is a 
better way to select procs for TSP compilation.  Since TSP compiles at the proc level, profilers that
also gather performance metrics as the proc level are ideal.

  - Importance of Unit testing

Another factor to consider when using TSP is unit testing of procs that are compiled, and those uncompiled
procs that invoke the compiled procs.  Since TSP is more sensitive to mis-matched data types than standard
Tcl, unit testing helps to locate code that may otherwise cause Tcl exceptions to be thrown.  For example,
a Tcl proc may expect an integer argument, and will only raise an exception when that variable is used
by a command that expects an integer (for example, the "incr" command).  TSP instead will raise 
an error immediately when the proc is invoked.  This requires that the invoking code to: a) ensures
that the proper type (or one that can be converted to the type) is passed to the compiled proc, or
b) catch the Tcl error tha can be generated by a failed conversion.

